# AI 文本优化助手

## 简介

**AI 文本优化助手** 是一款为 SillyTavern 设计的强大扩展，旨在提升您的聊天体验。它能够自动检测并优化 AI 生成的回复，确保内容符合您的预期，同时支持高度自定义的优化规则和多种 AI 服务商。

## 主要功能

- **自动优化**：实时监控 AI 生成的消息，当检测到您设定的“禁用词”时，自动调用 AI 对包含这些词的句子进行重写和优化。
- **手动优化**：提供一键式操作，可以手动触发对最后一条 AI 消息的分析和优化。
- **多 AI 服务商支持**：无缝集成多种 AI 服务，包括 OpenAI、Google、以及 SillyTavern 内置的后端代理。
- **高度可配置**：
    - **API 设置**：轻松配置您的 API 地址、密钥和模型。
    - **禁用词与过滤**：通过简单的逗号分隔列表来定义需要规避的词语，并支持使用正则表达式进行高级文本清理。
    - **自定义提示词**：您可以完全控制发送给 AI 的系统提示词，以实现最符合您需求的优化效果。
- **直观的用户界面**：在 SillyTavern 的扩展设置中提供了一个完整的控制面板，所有功能和设置都触手可及。

## 使用方法

### 自动优化

1.  前往 `扩展` -> `AI 文本优化助手` 设置面板。
2.  在 `API 设置` 中，配置好您的 AI 服务商、API URL、API 密钥和模型名称。点击 `测试连接` 和 `获取模型` 来确保一切正常。
3.  在 `禁用词与优化` 部分，填入您不希望看到的词语，用英文逗号 `,` 分隔。
4.  勾选 `自动优化` 复选框。
5.  现在，当 AI 生成的回复中包含任何禁用词时，扩展将自动启动优化流程，并将优化后的内容以新版本的形式添加到聊天中。

### 手动优化

如果您想对某条已生成的消息进行手动处理：

1.  在设置面板中，`最后一条角色消息` 文本框会自动显示最近的 AI 回复。
2.  点击 `提取待修改句子` 按钮，扩展会自动找出包含禁用词的句子并填充到 `待优化内容` 框中。
3.  您可以按需编辑 `待优化内容`。
4.  点击 `优化` 按钮，扩展会将内容发送给 AI 进行重写。
5.  优化后的结果会显示在 `优化后内容` 框中。
6.  最后，点击 `替换` 按钮，即可将原始消息中的相关部分替换为优化后的内容。

此外，您也可以使用 `一键全自动优化` 按钮来执行上述手动流程。

## 配置说明

### API 设置

- **API 提供商**：选择您要使用的 AI 服务。
    - `OpenAI`：适用于兼容 OpenAI 标准的 API 服务。
    - `OpenAI (测试)`：通过 SillyTavern 的后端进行 OpenAI API 请求。
    - `Google`：直接连接 Google 的 Gemini API。
    - `SillyTavern (后端)`：使用 SillyTavern 的自定义后端功能。
    - `SillyTavern (预设)`：使用 SillyTavern 当前的聊天补全设置。
- **API URL / 密钥 / 模型名称**：根据您选择的服务商填写相应的信息。

### 禁用词与正则表达式

- **禁用词列表**：一个简单的列表，用于指定需要被优化的关键词。
- **正则表达式过滤器**：在进行任何处理之前，使用正则表达式对原始文本进行清理。每行一个表达式，例如，可以用来移除特定的标点或格式。

### 提示词编写器

本扩展允许您精细调整用于优化的三个关键提示词：

- **主系统提示词 (通用)**：定义 AI 的基本角色和任务。
- **拦截任务详细指令**：给出关于如何处理和改写句子的具体指令。
- **最终注入指令**：在最后阶段对 AI 的输出格式等进行最终约束。

通过组合这些提示词，您可以引导 AI 生成更自然、更符合上下文的优化结果。

## 版本

- 1.0.0
